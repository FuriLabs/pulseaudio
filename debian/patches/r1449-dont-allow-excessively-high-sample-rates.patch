don't allow excessively high sample rates

From: lennart <lennart@fefdeb5f-60dc-0310-8127-8f9354f1896f>

git-svn-id: svn://svn.0pointer.net/pulseaudio/trunk@1449 fefdeb5f-60dc-0310-8127-8f9354f1896f
---

 src/pulse/sample.c |    1 +
 src/pulse/sample.h |    3 +++
 2 files changed, 4 insertions(+), 0 deletions(-)

diff --git a/src/pulse/sample.c b/src/pulse/sample.c
index 7ca418e..b259cca 100644
--- a/src/pulse/sample.c
+++ b/src/pulse/sample.c
@@ -77,6 +77,7 @@ int pa_sample_spec_valid(const pa_sample_spec *spec) {
     assert(spec);
 
     if (spec->rate <= 0 ||
+        spec->rate > PA_RATE_MAX ||
         spec->channels <= 0 ||
         spec->channels > PA_CHANNELS_MAX ||
         spec->format >= PA_SAMPLE_MAX ||
diff --git a/src/pulse/sample.h b/src/pulse/sample.h
index da32fdf..4b92873 100644
--- a/src/pulse/sample.h
+++ b/src/pulse/sample.h
@@ -102,6 +102,9 @@ PA_C_DECL_BEGIN
 /** Maximum number of allowed channels */
 #define PA_CHANNELS_MAX 32
 
+/** Maximum allowed sample rate */
+#define PA_RATE_MAX (48000*4)
+
 /** Sample format */
 typedef enum pa_sample_format {
     PA_SAMPLE_U8,              /**< Unsigned 8 Bit PCM */
